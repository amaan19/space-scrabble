!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i,o=function(){this.update=function(t,e){var n,i,o;for(n=e.length-1;n>=0;n--)i=e[n],o=r.vectorScalarMultiply(i.direction,i.speed),i.position=r.vectorAdd(i.position,r.vectorScalarMultiply(o,t))}},r=function(){function t(t,e){this.x=t,this.y=e}return t.vectorAdd=function(e,n){return new t(e.x+n.x,e.y+n.y)},t.vectorSubtract=function(e,n){return new t(e.x-n.x,e.y-n.y)},t.vectorScalarMultiply=function(e,n){return new t(e.x*n,e.y*n)},t.vectorLength=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.vectorNormalise=function(e){var n=1/(t.vectorLength(e)+1e-37);return t.vectorScalarMultiply(e,n)},t}(),c=function(){function t(t,e,n,i){var o=this;this.left=function(){return o.x},this.right=function(){return o.x+o.width},this.top=function(){return o.y},this.bottom=function(){return o.y+o.height},this.intersects=function(t){return o.right()>=t.left()&&o.left()<=t.right()&&o.top()<=t.bottom()&&o.bottom()>=t.top()},this.x=t,this.y=e,this.width=n,this.height=i}return t.rectUnion=function(e,n){return void 0===e?n:void 0===n?e:new t(Math.min(e.x,n.x),Math.min(e.y,n.y),Math.max(e.right(),n.right())-Math.min(e.left(),n.left()),Math.max(e.bottom(),n.bottom())-Math.min(e.top(),n.top()))},t}(),u=new c(0,0,300,180),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.update=function(e){t.prototype.update.call(o,e),(o.collisionRect().top()<=0||o.collisionRect().bottom()>=u.bottom())&&(o.direction.y*=-1)},o.width=20,o.height=10,o}return s(e,t),e}(p),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),f=function(t){function e(e,n,i,o){var r=t.call(this,e,n,i)||this;return r.update=function(e){t.prototype.update.call(r,e),(r.collisionRect().top()<=0||r.collisionRect().bottom()>=u.bottom())&&(r.direction.y*=-1)},r.width=13,r.height=10,r.rank=o,r}return h(e,t),e}(p),l=function(){var t=this;this.enemyColors=["rgb(150, 7, 7)","rgb(150, 89, 7)","rgb(56, 150, 7)","rgb(7, 150, 122)","rgb(46, 7, 150)"],this.drawRectangle=function(e,n){t.context.fillStyle=e,t.context.fillRect(n.position.x-n.width/2,n.position.y-n.height/2,n.width,n.height)},this.render=function(e,n){var i,o;for(t.context.fillStyle="black",t.context.fillRect(0,0,t.width,t.height),i=0;i<n.length;i++)(o=n[i])instanceof f?t.drawRectangle(t.enemyColors[o.rank],o):o instanceof a&&t.drawRectangle("rgb(255, 255, 0)",o)},this.canvas=document.querySelector("#game-layer"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height},d=function(){var t=this;this.started=!1,this.start=function(){t.entities=[],t.enemies=[],t.physics=new o,t.renderer=new l,t.addEntity(new a(new r(100,175),25,new r(0,-1))),t.addEntity(new f(new r(20,25),20,new r(0,1),0)),t.addEntity(new f(new r(50,25),10,new r(0,1),1)),t.addEntity(new f(new r(80,25),15,new r(0,1),2)),t.addEntity(new f(new r(120,25),25,new r(0,1),3)),t.addEntity(new f(new r(140,25),30,new r(0,1),4)),t.started||(window.requestAnimationFrame(t.update),t.started=!0)},this.addEntity=function(e){t.entities.push(e),e instanceof a&&(t.player=e),e instanceof f&&t.enemies.push(e)},this.removeEntities=function(){if(t.entities){var e=function(e){return!t.entities.includes(e)};t.entities=t.entities.filter(e),t.enemies=t.enemies.filter(e),t.entities.includes(t.player)&&(t.player=void 0)}},this.update=function(){var e;for(t.physics.update(1/60,t.entities),e=t.entities.length-1;e>=0;e--)t.entities[e].update(1/60);t.renderer.render(1/60,t.entities),window.requestAnimationFrame(t.update)}},p=function(){function t(t,e,n){var i=this;this.collisionRect=function(){return new c(i.position.x-i.width/2,i.position.y-i.height/2,i.width,i.height)},this.position=t,this.speed=e,this.direction=n,this.time=0,this.width=5,this.height=5,this.hp=1}return t.prototype.update=function(t){this.time+=t},t}();(new d).start()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC9QaHlzaWNzLnRzIiwid2VicGFjazovLy8uL3NyYy9jb25maWcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC9QbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC9FbmVteS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBwL1JlbmRlcmVyLnRzIiwid2VicGFjazovLy8uL3NyYy9hcHAvQXBwLnRzIiwid2VicGFjazovLy8uL3NyYy9nYW1lLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidXBkYXRlIiwiZHQiLCJlbnRpdGllcyIsImUiLCJ2ZWxvY2l0eSIsImxlbmd0aCIsIlZlY3RvcjJkIiwidmVjdG9yU2NhbGFyTXVsdGlwbHkiLCJkaXJlY3Rpb24iLCJzcGVlZCIsInBvc2l0aW9uIiwidmVjdG9yQWRkIiwieCIsInkiLCJ0aGlzIiwidjEiLCJ2MiIsInZlY3RvclN1YnRyYWN0IiwidiIsInZlY3Rvckxlbmd0aCIsIk1hdGgiLCJzcXJ0IiwidmVjdG9yTm9ybWFsaXNlIiwicmVjaXByb2NhbCIsIndpZHRoIiwiaGVpZ2h0IiwibGVmdCIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwiaW50ZXJzZWN0cyIsInJlY3RhbmdsZSIsInJlY3RVbmlvbiIsInIxIiwicjIiLCJ1bmRlZmluZWQiLCJSZWN0YW5nbGUiLCJtaW4iLCJtYXgiLCJnYW1lRmllbGRSZWN0IiwiY29sbGlzaW9uUmVjdCIsInJhbmsiLCJlbmVteUNvbG9ycyIsImRyYXdSZWN0YW5nbGUiLCJjb2xvdXIiLCJlbnRpdHkiLCJjb250ZXh0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJyZW5kZXIiLCJjYW52YXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRDb250ZXh0Iiwic3RhcnRlZCIsInN0YXJ0IiwiZW5lbWllcyIsInBoeXNpY3MiLCJQaHlzaWNzIiwicmVuZGVyZXIiLCJhZGRFbnRpdHkiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJwdXNoIiwicGxheWVyIiwicmVtb3ZlRW50aXRpZXMiLCJpc05vdEluRW50aXRpZXMiLCJpdGVtIiwiaW5jbHVkZXMiLCJmaWx0ZXIiLCJ0aW1lIiwiaHAiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsc0NDaEZyRCxJLEVBQUEsYUFDSSxLQUFBQyxPQUFTLFNBQUNDLEVBQVlDLEdBQ3RCLElBQUlsQyxFQUNBbUMsRUFDQUMsRUFFSixJQUFLcEMsRUFBSWtDLEVBQVNHLE9BQVMsRUFBR3JDLEdBQUksRUFBR0EsSUFDakNtQyxFQUFJRCxFQUFTbEMsR0FDYm9DLEVBQVdFLEVBQVNDLHFCQUFzQkosRUFBRUssVUFBV0wsRUFBRU0sT0FDekROLEVBQUVPLFNBQVdKLEVBQVNLLFVBQVVSLEVBQUVPLFNBQVVKLEVBQVNDLHFCQUFxQkgsRUFBVUgsTUFLNUYsYUFJSSxXQUFZVyxFQUFXQyxHQUNuQkMsS0FBS0YsRUFBSUEsRUFDVEUsS0FBS0QsRUFBSUEsRUF3QmpCLE9BckJXLEVBQUFGLFVBQVksU0FBQ0ksRUFBY0MsR0FDOUIsT0FBTyxJQUFJVixFQUFTUyxFQUFHSCxFQUFJSSxFQUFHSixFQUFHRyxFQUFHRixFQUFJRyxFQUFHSCxJQUd4QyxFQUFBSSxlQUFpQixTQUFDRixFQUFjQyxHQUNuQyxPQUFPLElBQUlWLEVBQVNTLEVBQUdILEVBQUlJLEVBQUdKLEVBQUdHLEVBQUdGLEVBQUlHLEVBQUdILElBR3hDLEVBQUFOLHFCQUF1QixTQUFDVyxFQUFhbkIsR0FDeEMsT0FBTyxJQUFJTyxFQUFTWSxFQUFFTixFQUFJYixFQUFHbUIsRUFBRUwsRUFBSWQsSUFHaEMsRUFBQW9CLGFBQWUsU0FBQ0QsR0FDbkIsT0FBT0UsS0FBS0MsS0FBS0gsRUFBRU4sRUFBSU0sRUFBRU4sRUFBSU0sRUFBRUwsRUFBSUssRUFBRUwsSUFHbEMsRUFBQVMsZ0JBQWtCLFNBQUNKLEdBQ3RCLElBQUlLLEVBQWEsR0FBT2pCLEVBQVNhLGFBQWFELEdBQUssT0FDbkQsT0FBT1osRUFBU0MscUJBQXFCVyxFQUFHSyxJQUdoRCxFQTlCQSxHQWdDQSxhQU1JLFdBQVlYLEVBQVdDLEVBQVdXLEVBQWVDLEdBQWpELFdBT0EsS0FBQUMsS0FBTyxXQUNILE9BQU8sRUFBS2QsR0FHaEIsS0FBQWUsTUFBUSxXQUNKLE9BQU8sRUFBS2YsRUFBSSxFQUFLWSxPQUd6QixLQUFBSSxJQUFNLFdBQ0YsT0FBTyxFQUFLZixHQUdoQixLQUFBZ0IsT0FBUyxXQUNMLE9BQU8sRUFBS2hCLEVBQUksRUFBS1ksUUFHekIsS0FBQUssV0FBYSxTQUFDQyxHQUNWLE9BQU8sRUFBS0osU0FBV0ksRUFBVUwsUUFBVSxFQUFLQSxRQUFVSyxFQUFVSixTQUFXLEVBQUtDLE9BQVNHLEVBQVVGLFVBQVksRUFBS0EsVUFBWUUsRUFBVUgsT0F2QjlJZCxLQUFLRixFQUFJQSxFQUNURSxLQUFLRCxFQUFJQSxFQUNUQyxLQUFLVSxNQUFRQSxFQUNiVixLQUFLVyxPQUFTQSxFQXNDdEIsT0FmVyxFQUFBTyxVQUFZLFNBQUNDLEVBQWVDLEdBQy9CLFlBQVdDLElBQVBGLEVBQ09DLE9BRUFDLElBQVBELEVBQ09ELEVBUUosSUFBSUcsRUFMSGhCLEtBQUtpQixJQUFJSixFQUFHckIsRUFBR3NCLEVBQUd0QixHQUNsQlEsS0FBS2lCLElBQUlKLEVBQUdwQixFQUFHcUIsRUFBR3JCLEdBQ2RPLEtBQUtrQixJQUFJTCxFQUFHTixRQUFTTyxFQUFHUCxTQUFXUCxLQUFLaUIsSUFBSUosRUFBR1AsT0FBUVEsRUFBR1IsUUFDekROLEtBQUtrQixJQUFJTCxFQUFHSixTQUFVSyxFQUFHTCxVQUFZVCxLQUFLaUIsSUFBSUosRUFBR0wsTUFBT00sRUFBR04sU0FJaEYsRUFoREEsR0M5Q2FXLEVBQWdCLElBQUlILEVBQVUsRUFBRyxFQUFHLElBQUssSyxvVENFdEQsY0FJRSxXQUFZMUIsRUFBb0JELEVBQWVELEdBQS9DLE1BQ0UsWUFBTUUsRUFBVUQsRUFBT0QsSUFBVSxLLE9BS25DLEVBQUFSLE9BQVMsU0FBQ0MsR0FDUixZQUFNRCxPQUFNLE9BQUNDLElBRVgsRUFBS3VDLGdCQUFnQlosT0FBUyxHQUM5QixFQUFLWSxnQkFBZ0JYLFVBQVlVLEVBQWNWLFlBRS9DLEVBQUtyQixVQUFVSyxJQUFNLElBVnZCLEVBQUtXLE1BQVEsR0FDYixFQUFLQyxPQUFTLEcsRUFZbEIsT0FuQjRCLE9BbUI1QixFQW5CQSxDQUE0QixHLDJVQ0E1QixjQUtFLFdBQ0VmLEVBQ0FELEVBQ0FELEVBQ0FpQyxHQUpGLE1BTUUsWUFBTS9CLEVBQVVELEVBQU9ELElBQVUsSyxPQU1uQyxFQUFBUixPQUFTLFNBQUNDLEdBQ1IsWUFBTUQsT0FBTSxPQUFDQyxJQUVYLEVBQUt1QyxnQkFBZ0JaLE9BQVMsR0FDOUIsRUFBS1ksZ0JBQWdCWCxVQUFZVSxFQUFjVixZQUUvQyxFQUFLckIsVUFBVUssSUFBTSxJQVh2QixFQUFLVyxNQUFRLEdBQ2IsRUFBS0MsT0FBUyxHQUNkLEVBQUtnQixLQUFPQSxFLEVBWWhCLE9BMUIyQixPQTBCM0IsRUExQkEsQ0FBMkIsR0NBM0IsRUFRRSxzQkFPQSxLQUFBQyxZQUFjLENBQ1osaUJBQ0Esa0JBQ0Esa0JBQ0EsbUJBQ0EsbUJBR0YsS0FBQUMsY0FBZ0IsU0FBQ0MsRUFBZ0JDLEdBQy9CLEVBQUtDLFFBQVFDLFVBQVlILEVBQ3pCLEVBQUtFLFFBQVFFLFNBQ1hILEVBQU9uQyxTQUFTRSxFQUFJaUMsRUFBT3JCLE1BQVEsRUFDbkNxQixFQUFPbkMsU0FBU0csRUFBSWdDLEVBQU9wQixPQUFTLEVBQ3BDb0IsRUFBT3JCLE1BQ1BxQixFQUFPcEIsU0FJWCxLQUFBd0IsT0FBUyxTQUFDaEQsRUFBWUMsR0FJcEIsSUFBSWxDLEVBQ0E2RSxFQUVKLElBTkEsRUFBS0MsUUFBUUMsVUFBWSxRQUN6QixFQUFLRCxRQUFRRSxTQUFTLEVBQUcsRUFBRyxFQUFLeEIsTUFBTyxFQUFLQyxRQUt4Q3pELEVBQUksRUFBR0EsRUFBSWtDLEVBQVNHLE9BQVFyQyxLQUMvQjZFLEVBQVMzQyxFQUFTbEMsY0FDSSxFQUNwQixFQUFLMkUsY0FBYyxFQUFLRCxZQUFZRyxFQUFPSixNQUFPSSxHQUN6Q0EsYUFBa0IsR0FDM0IsRUFBS0YsY0FBYyxtQkFBb0JFLElBcEMzQy9CLEtBQUtvQyxPQUFTQyxTQUFTQyxjQUFjLGVBQ3JDdEMsS0FBS2dDLFFBQVVoQyxLQUFLb0MsT0FBT0csV0FBVyxNQUN0Q3ZDLEtBQUtVLE1BQVFWLEtBQUtvQyxPQUFPMUIsTUFDekJWLEtBQUtXLE9BQVNYLEtBQUtvQyxPQUFPekIsUUNWOUIsd0JBT0UsS0FBQTZCLFNBQVUsRUFFVixLQUFBQyxNQUFRLFdBQ04sRUFBS3JELFNBQVcsR0FDaEIsRUFBS3NELFFBQVUsR0FDZixFQUFLQyxRQUFVLElBQUlDLEVBQ25CLEVBQUtDLFNBQVcsSUFBSSxFQUdwQixFQUFLQyxVQUFVLElBQUksRUFBTyxJQUFJdEQsRUFBUyxJQUFLLEtBQU0sR0FBSSxJQUFJQSxFQUFTLEdBQUksS0FDdkUsRUFBS3NELFVBQVUsSUFBSSxFQUFNLElBQUl0RCxFQUFTLEdBQUksSUFBSyxHQUFJLElBQUlBLEVBQVMsRUFBRyxHQUFJLElBQ3ZFLEVBQUtzRCxVQUFVLElBQUksRUFBTSxJQUFJdEQsRUFBUyxHQUFJLElBQUssR0FBSSxJQUFJQSxFQUFTLEVBQUcsR0FBSSxJQUN2RSxFQUFLc0QsVUFBVSxJQUFJLEVBQU0sSUFBSXRELEVBQVMsR0FBSSxJQUFLLEdBQUksSUFBSUEsRUFBUyxFQUFHLEdBQUksSUFDdkUsRUFBS3NELFVBQVUsSUFBSSxFQUFNLElBQUl0RCxFQUFTLElBQUssSUFBSyxHQUFJLElBQUlBLEVBQVMsRUFBRyxHQUFJLElBQ3hFLEVBQUtzRCxVQUFVLElBQUksRUFBTSxJQUFJdEQsRUFBUyxJQUFLLElBQUssR0FBSSxJQUFJQSxFQUFTLEVBQUcsR0FBSSxJQUVuRSxFQUFLZ0QsVUFDUk8sT0FBT0Msc0JBQXNCLEVBQUs5RCxRQUNsQyxFQUFLc0QsU0FBVSxJQUluQixLQUFBTSxVQUFZLFNBQUNmLEdBQ1gsRUFBSzNDLFNBQVM2RCxLQUFLbEIsR0FFZkEsYUFBa0IsSUFDcEIsRUFBS21CLE9BQVNuQixHQUdaQSxhQUFrQixHQUNwQixFQUFLVyxRQUFRTyxLQUFLbEIsSUFJdEIsS0FBQW9CLGVBQWlCLFdBQ2YsR0FBSyxFQUFLL0QsU0FBVixDQUVBLElBQUlnRSxFQUFrQixTQUFDQyxHQUNyQixPQUFRLEVBQUtqRSxTQUFTa0UsU0FBU0QsSUFHakMsRUFBS2pFLFNBQVcsRUFBS0EsU0FBU21FLE9BQU9ILEdBQ3JDLEVBQUtWLFFBQVUsRUFBS0EsUUFBUWEsT0FBT0gsR0FFL0IsRUFBS2hFLFNBQVNrRSxTQUFTLEVBQUtKLFVBQzlCLEVBQUtBLFlBQVM3QixLQUlsQixLQUFBbkMsT0FBUyxXQUNQLElBR0loQyxFQUNKLElBSEEsRUFBS3lGLFFBQVF6RCxPQURKLEVBQUksR0FDVyxFQUFLRSxVQUd4QmxDLEVBQUksRUFBS2tDLFNBQVNHLE9BQVMsRUFBR3JDLEdBQUssRUFBR0EsSUFDekMsRUFBS2tDLFNBQVNsQyxHQUFHZ0MsT0FMVixFQUFJLElBT2IsRUFBSzJELFNBQVNWLE9BUEwsRUFBSSxHQU9ZLEVBQUsvQyxVQUU5QjJELE9BQU9DLHNCQUFzQixFQUFLOUQsVUFJdEMsYUFRRSxXQUFZVSxFQUFvQkQsRUFBZUQsR0FBL0MsV0FjQSxLQUFBZ0MsY0FBZ0IsV0FDZCxPQUFPLElBQUlKLEVBQ1QsRUFBSzFCLFNBQVNFLEVBQUksRUFBS1ksTUFBUSxFQUMvQixFQUFLZCxTQUFTRyxFQUFJLEVBQUtZLE9BQVMsRUFDaEMsRUFBS0QsTUFDTCxFQUFLQyxTQWxCUFgsS0FBS0osU0FBV0EsRUFDaEJJLEtBQUtMLE1BQVFBLEVBQ2JLLEtBQUtOLFVBQVlBLEVBQ2pCTSxLQUFLd0QsS0FBTyxFQUNaeEQsS0FBS1UsTUFBUSxFQUNiVixLQUFLVyxPQUFTLEVBQ2RYLEtBQUt5RCxHQUFLLEVBZWQsT0FaRSxZQUFBdkUsT0FBQSxTQUFPQyxHQUNMYSxLQUFLd0QsTUFBUXJFLEdBV2pCLEVBOUJBLElDeEVhLElBQUksR0FDWnNEIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IEVudGl0eSB9IGZyb20gXCIuL0FwcFwiO1xuXG5leHBvcnQgY2xhc3MgUGh5c2ljcyB7XG4gICAgdXBkYXRlID0gKGR0OiBudW1iZXIsIGVudGl0aWVzOiBFbnRpdHlbXSkgPT4ge1xuICAgIGxldCBpO1xuICAgIGxldCBlO1xuICAgIGxldCB2ZWxvY2l0eTtcblxuICAgIGZvciAoaSA9IGVudGl0aWVzLmxlbmd0aCAtIDE7IGkgPj0wOyBpLS0pIHtcbiAgICAgICAgZSA9IGVudGl0aWVzW2ldO1xuICAgICAgICB2ZWxvY2l0eSA9IFZlY3RvcjJkLnZlY3RvclNjYWxhck11bHRpcGx5KCBlLmRpcmVjdGlvbiwgZS5zcGVlZClcbiAgICAgICAgZS5wb3NpdGlvbiA9IFZlY3RvcjJkLnZlY3RvckFkZChlLnBvc2l0aW9uLCBWZWN0b3IyZC52ZWN0b3JTY2FsYXJNdWx0aXBseSh2ZWxvY2l0eSwgZHQpKVxuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIFZlY3RvcjJkIHtcbiAgICB4OiBudW1iZXI7XG4gICAgeTogbnVtYmVyOyBcblxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTpudW1iZXIpIHtcbiAgICAgICAgdGhpcy54ID0geFxuICAgICAgICB0aGlzLnkgPSB5IFxuICAgIH1cblxuICAgIHN0YXRpYyB2ZWN0b3JBZGQgPSAodjE6IFZlY3RvcjJkLCB2MjogVmVjdG9yMmQpID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyZCh2MS54ICsgdjIueCwgdjEueSArIHYyLnkpO1xuICAgIH1cblxuICAgIHN0YXRpYyB2ZWN0b3JTdWJ0cmFjdCA9ICh2MTogVmVjdG9yMmQsIHYyOiBWZWN0b3IyZCkgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJkKHYxLnggLSB2Mi54LCB2MS55IC0gdjIueSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHZlY3RvclNjYWxhck11bHRpcGx5ID0gKHY6IFZlY3RvcjJkLCBzOiBudW1iZXIpID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyZCh2LnggKiBzLCB2LnkgKiBzKVxuICAgIH1cblxuICAgIHN0YXRpYyB2ZWN0b3JMZW5ndGggPSAodjogVmVjdG9yMmQpID0+IHtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh2LnggKiB2LnggKyB2LnkgKiB2LnkpXG4gICAgfVxuXG4gICAgc3RhdGljIHZlY3Rvck5vcm1hbGlzZSA9ICh2OiBWZWN0b3IyZCkgPT4gIHtcbiAgICAgICAgbGV0IHJlY2lwcm9jYWwgPSAxLjAgLyAoVmVjdG9yMmQudmVjdG9yTGVuZ3RoKHYpICsgMS4wZS0wMzcpO1xuICAgICAgICByZXR1cm4gVmVjdG9yMmQudmVjdG9yU2NhbGFyTXVsdGlwbHkodiwgcmVjaXByb2NhbClcbiAgICB9XG5cbn1cblxuZXhwb3J0IGNsYXNzIFJlY3RhbmdsZSB7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbiAgICB3aWR0aDogbnVtYmVyO1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICB0aGlzLnggPSB4XG4gICAgICAgIHRoaXMueSA9IHlcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0XG4gICAgfVxuXG4gICAgbGVmdCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMueCBcbiAgICB9XG5cbiAgICByaWdodCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGggXG4gICAgfVxuXG4gICAgdG9wID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy55XG4gICAgfVxuXG4gICAgYm90dG9tID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQgXG4gICAgfVxuXG4gICAgaW50ZXJzZWN0cyA9IChyZWN0YW5nbGU6IFJlY3RhbmdsZSkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodCgpID49IHJlY3RhbmdsZS5sZWZ0KCkgJiYgdGhpcy5sZWZ0KCkgPD0gcmVjdGFuZ2xlLnJpZ2h0KCkgJiYgdGhpcy50b3AoKSA8PSByZWN0YW5nbGUuYm90dG9tKCkgJiYgdGhpcy5ib3R0b20oKSA+PSByZWN0YW5nbGUudG9wKCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHJlY3RVbmlvbiA9IChyMTogUmVjdGFuZ2xlLCByMjogUmVjdGFuZ2xlKSA9PiB7XG4gICAgICAgIGlmIChyMSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcjI7IFxuICAgICAgICB9XG4gICAgICAgIGlmIChyMiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcjEgXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgeCA9IE1hdGgubWluKHIxLngsIHIyLngpO1xuICAgICAgICBsZXQgeSA9IE1hdGgubWluKHIxLnksIHIyLnkpO1xuICAgICAgICBsZXQgd2lkdGggPSBNYXRoLm1heChyMS5yaWdodCgpLCByMi5yaWdodCgpKSAtIE1hdGgubWluKHIxLmxlZnQoKSwgcjIubGVmdCgpKTtcbiAgICAgICAgbGV0IGhlaWdodCA9IE1hdGgubWF4KHIxLmJvdHRvbSgpLCByMi5ib3R0b20oKSkgLSBNYXRoLm1pbihyMS50b3AoKSwgcjIudG9wKCkpOyBcblxuICAgICAgICByZXR1cm4gbmV3IFJlY3RhbmdsZSh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9XG59IiwiaW1wb3J0IHsgUmVjdGFuZ2xlIH0gZnJvbSBcIi4vYXBwL1BoeXNpY3NcIjtcblxuZXhwb3J0IGNvbnN0IGdhbWVGaWVsZFJlY3QgPSBuZXcgUmVjdGFuZ2xlKDAsIDAsIDMwMCwgMTgwKTsiLCJpbXBvcnQgeyBFbnRpdHkgfSBmcm9tIFwiLi9BcHBcIjtcbmltcG9ydCB7IFZlY3RvcjJkIH0gZnJvbSBcIi4vUGh5c2ljc1wiO1xuaW1wb3J0IHsgZ2FtZUZpZWxkUmVjdCB9IGZyb20gXCIuLi9jb25maWdcIjtcblxuZXhwb3J0IGNsYXNzIFBsYXllciBleHRlbmRzIEVudGl0eSB7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHBvc2l0aW9uOiBWZWN0b3IyZCwgc3BlZWQ6IG51bWJlciwgZGlyZWN0aW9uOiBWZWN0b3IyZCkge1xuICAgIHN1cGVyKHBvc2l0aW9uLCBzcGVlZCwgZGlyZWN0aW9uKTtcbiAgICB0aGlzLndpZHRoID0gMjA7XG4gICAgdGhpcy5oZWlnaHQgPSAxMDtcbiAgfVxuXG4gIHVwZGF0ZSA9IChkdDogbnVtYmVyKSA9PiB7XG4gICAgc3VwZXIudXBkYXRlKGR0KTtcbiAgICBpZiAoXG4gICAgICB0aGlzLmNvbGxpc2lvblJlY3QoKS50b3AoKSA8PSAwIHx8XG4gICAgICB0aGlzLmNvbGxpc2lvblJlY3QoKS5ib3R0b20oKSA+PSBnYW1lRmllbGRSZWN0LmJvdHRvbSgpXG4gICAgKSB7XG4gICAgICB0aGlzLmRpcmVjdGlvbi55ICo9IC0xO1xuICAgIH1cbiAgfTtcbn1cbiIsImltcG9ydCB7IEVudGl0eSB9IGZyb20gXCIuL0FwcFwiO1xuaW1wb3J0IHsgVmVjdG9yMmQgfSBmcm9tIFwiLi9QaHlzaWNzXCI7XG5pbXBvcnQgeyBnYW1lRmllbGRSZWN0IH0gZnJvbSBcIi4uL2NvbmZpZ1wiO1xuXG5leHBvcnQgY2xhc3MgRW5lbXkgZXh0ZW5kcyBFbnRpdHkge1xuICByYW5rOiBudW1iZXI7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBvc2l0aW9uOiBWZWN0b3IyZCxcbiAgICBzcGVlZDogbnVtYmVyLFxuICAgIGRpcmVjdGlvbjogVmVjdG9yMmQsXG4gICAgcmFuazogbnVtYmVyXG4gICkge1xuICAgIHN1cGVyKHBvc2l0aW9uLCBzcGVlZCwgZGlyZWN0aW9uKTtcbiAgICB0aGlzLndpZHRoID0gMTM7XG4gICAgdGhpcy5oZWlnaHQgPSAxMDtcbiAgICB0aGlzLnJhbmsgPSByYW5rO1xuICB9XG5cbiAgdXBkYXRlID0gKGR0OiBhbnkpID0+IHtcbiAgICBzdXBlci51cGRhdGUoZHQpO1xuICAgIGlmIChcbiAgICAgIHRoaXMuY29sbGlzaW9uUmVjdCgpLnRvcCgpIDw9IDAgfHxcbiAgICAgIHRoaXMuY29sbGlzaW9uUmVjdCgpLmJvdHRvbSgpID49IGdhbWVGaWVsZFJlY3QuYm90dG9tKClcbiAgICApIHtcbiAgICAgIHRoaXMuZGlyZWN0aW9uLnkgKj0gLTE7XG4gICAgfVxuICB9O1xufVxuIiwiaW1wb3J0IHsgRW50aXR5LCBHYW1lIH0gZnJvbSBcIi4vQXBwXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9QbGF5ZXJcIjtcbmltcG9ydCB7IEVuZW15IH0gZnJvbSBcIi4vRW5lbXlcIjtcblxuZXhwb3J0IGNsYXNzIFJlbmRlcmVyIHtcbiAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcbiAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICB3aWR0aDogYW55O1xuICBoZWlnaHQ6IGFueTtcblxuICAvL0NoYW5nZSB0byBudW1iZXIgYW5kIHNob3cgdG8gU2FtXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2dhbWUtbGF5ZXJcIikgYXMgdW5rbm93biBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgdGhpcy53aWR0aCA9IHRoaXMuY2FudmFzLndpZHRoO1xuICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5jYW52YXMuaGVpZ2h0O1xuICB9XG5cbiAgZW5lbXlDb2xvcnMgPSBbXG4gICAgXCJyZ2IoMTUwLCA3LCA3KVwiLFxuICAgIFwicmdiKDE1MCwgODksIDcpXCIsXG4gICAgXCJyZ2IoNTYsIDE1MCwgNylcIixcbiAgICBcInJnYig3LCAxNTAsIDEyMilcIixcbiAgICBcInJnYig0NiwgNywgMTUwKVwiXG4gIF07XG5cbiAgZHJhd1JlY3RhbmdsZSA9IChjb2xvdXI6IHN0cmluZywgZW50aXR5OiBFbnRpdHkpID0+IHtcbiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gY29sb3VyO1xuICAgIHRoaXMuY29udGV4dC5maWxsUmVjdChcbiAgICAgIGVudGl0eS5wb3NpdGlvbi54IC0gZW50aXR5LndpZHRoIC8gMixcbiAgICAgIGVudGl0eS5wb3NpdGlvbi55IC0gZW50aXR5LmhlaWdodCAvIDIsXG4gICAgICBlbnRpdHkud2lkdGgsXG4gICAgICBlbnRpdHkuaGVpZ2h0XG4gICAgKTtcbiAgfTtcblxuICByZW5kZXIgPSAoZHQ6IG51bWJlciwgZW50aXRpZXM6IEVudGl0eVtdKSA9PiB7XG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuXG4gICAgbGV0IGk7XG4gICAgbGV0IGVudGl0eTtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBlbnRpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgZW50aXR5ID0gZW50aXRpZXNbaV07XG4gICAgICBpZiAoZW50aXR5IGluc3RhbmNlb2YgRW5lbXkpIHtcbiAgICAgICAgdGhpcy5kcmF3UmVjdGFuZ2xlKHRoaXMuZW5lbXlDb2xvcnNbZW50aXR5LnJhbmtdLCBlbnRpdHkpO1xuICAgICAgfSBlbHNlIGlmIChlbnRpdHkgaW5zdGFuY2VvZiBQbGF5ZXIpIHtcbiAgICAgICAgdGhpcy5kcmF3UmVjdGFuZ2xlKFwicmdiKDI1NSwgMjU1LCAwKVwiLCBlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL1BsYXllclwiO1xuaW1wb3J0IHsgRW5lbXkgfSBmcm9tIFwiLi9FbmVteVwiO1xuaW1wb3J0IHsgUmVjdGFuZ2xlLCBWZWN0b3IyZCwgUGh5c2ljcyB9IGZyb20gXCIuL1BoeXNpY3NcIjtcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSBcIi4vUmVuZGVyZXJcIjtcbi8vIGltcG9ydCB7Z2FtZUZpZWxkUmVjdH0gZnJvbSAnLi4vY29uZmlnJ1xuXG5leHBvcnQgY2xhc3MgR2FtZSB7XG4gIGVudGl0aWVzOiBFbnRpdHlbXTtcbiAgZW5lbWllczogRW5lbXlbXTtcbiAgcGxheWVyOiBQbGF5ZXI7XG4gIHBoeXNpY3M6IFBoeXNpY3M7XG4gIHJlbmRlcmVyOiBSZW5kZXJlcjtcbiAgLy8gZ2FtZUZpZWxkUmVjdDogUmVjdGFuZ2xlO1xuICBzdGFydGVkID0gZmFsc2U7XG5cbiAgc3RhcnQgPSAoKSA9PiB7XG4gICAgdGhpcy5lbnRpdGllcyA9IFtdO1xuICAgIHRoaXMuZW5lbWllcyA9IFtdO1xuICAgIHRoaXMucGh5c2ljcyA9IG5ldyBQaHlzaWNzXG4gICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlclxuICAgIC8vIHRoaXMuZ2FtZUZpZWxkUmVjdCA9IG5ldyBSZWN0YW5nbGUoMCwgMCwgMzAwLCAxODApO1xuXG4gICAgdGhpcy5hZGRFbnRpdHkobmV3IFBsYXllcihuZXcgVmVjdG9yMmQoMTAwLCAxNzUpLCAyNSwgbmV3IFZlY3RvcjJkKDAsIC0xKSkpO1xuICAgIHRoaXMuYWRkRW50aXR5KG5ldyBFbmVteShuZXcgVmVjdG9yMmQoMjAsIDI1KSwgMjAsIG5ldyBWZWN0b3IyZCgwLCAxKSwgMCkpO1xuICAgIHRoaXMuYWRkRW50aXR5KG5ldyBFbmVteShuZXcgVmVjdG9yMmQoNTAsIDI1KSwgMTAsIG5ldyBWZWN0b3IyZCgwLCAxKSwgMSkpO1xuICAgIHRoaXMuYWRkRW50aXR5KG5ldyBFbmVteShuZXcgVmVjdG9yMmQoODAsIDI1KSwgMTUsIG5ldyBWZWN0b3IyZCgwLCAxKSwgMikpO1xuICAgIHRoaXMuYWRkRW50aXR5KG5ldyBFbmVteShuZXcgVmVjdG9yMmQoMTIwLCAyNSksIDI1LCBuZXcgVmVjdG9yMmQoMCwgMSksIDMpKTtcbiAgICB0aGlzLmFkZEVudGl0eShuZXcgRW5lbXkobmV3IFZlY3RvcjJkKDE0MCwgMjUpLCAzMCwgbmV3IFZlY3RvcjJkKDAsIDEpLCA0KSk7XG5cbiAgICBpZiAoIXRoaXMuc3RhcnRlZCkge1xuICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSk7XG4gICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBhZGRFbnRpdHkgPSAoZW50aXR5OiBFbnRpdHkpID0+IHtcbiAgICB0aGlzLmVudGl0aWVzLnB1c2goZW50aXR5KTtcblxuICAgIGlmIChlbnRpdHkgaW5zdGFuY2VvZiBQbGF5ZXIpIHtcbiAgICAgIHRoaXMucGxheWVyID0gZW50aXR5O1xuICAgIH1cblxuICAgIGlmIChlbnRpdHkgaW5zdGFuY2VvZiBFbmVteSkge1xuICAgICAgdGhpcy5lbmVtaWVzLnB1c2goZW50aXR5KTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVFbnRpdGllcyA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuZW50aXRpZXMpIHJldHVybjtcblxuICAgIGxldCBpc05vdEluRW50aXRpZXMgPSAoaXRlbTpFbnRpdHkpID0+IHtcbiAgICAgIHJldHVybiAhdGhpcy5lbnRpdGllcy5pbmNsdWRlcyhpdGVtKTtcbiAgICB9O1xuXG4gICAgdGhpcy5lbnRpdGllcyA9IHRoaXMuZW50aXRpZXMuZmlsdGVyKGlzTm90SW5FbnRpdGllcyk7XG4gICAgdGhpcy5lbmVtaWVzID0gdGhpcy5lbmVtaWVzLmZpbHRlcihpc05vdEluRW50aXRpZXMpO1xuXG4gICAgaWYgKHRoaXMuZW50aXRpZXMuaW5jbHVkZXModGhpcy5wbGF5ZXIpKSB7XG4gICAgICB0aGlzLnBsYXllciA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG5cbiAgdXBkYXRlID0gKCkgPT4ge1xuICAgIGxldCBkdCA9IDEgLyA2MDtcbiAgICB0aGlzLnBoeXNpY3MudXBkYXRlKGR0LCB0aGlzLmVudGl0aWVzKTtcblxuICAgIGxldCBpO1xuICAgIGZvciAoaSA9IHRoaXMuZW50aXRpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHRoaXMuZW50aXRpZXNbaV0udXBkYXRlKGR0KTtcbiAgICB9XG4gICAgdGhpcy5yZW5kZXJlci5yZW5kZXIoZHQsIHRoaXMuZW50aXRpZXMpO1xuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSk7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbnRpdHkge1xuICBwb3NpdGlvbjogVmVjdG9yMmQ7XG4gIHNwZWVkOiBhbnk7XG4gIGRpcmVjdGlvbjogVmVjdG9yMmQ7XG4gIHRpbWU6IG51bWJlcjtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG4gIGhwOiBudW1iZXI7XG4gIGNvbnN0cnVjdG9yKHBvc2l0aW9uOiBWZWN0b3IyZCwgc3BlZWQ6IG51bWJlciwgZGlyZWN0aW9uOiBWZWN0b3IyZCkge1xuICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XG4gICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgdGhpcy50aW1lID0gMDtcbiAgICB0aGlzLndpZHRoID0gNTtcbiAgICB0aGlzLmhlaWdodCA9IDU7XG4gICAgdGhpcy5ocCA9IDE7XG4gIH1cblxuICB1cGRhdGUoZHQ6IG51bWJlcikge1xuICAgIHRoaXMudGltZSArPSBkdDtcbiAgfVxuXG4gIGNvbGxpc2lvblJlY3QgPSAoKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBSZWN0YW5nbGUoXG4gICAgICB0aGlzLnBvc2l0aW9uLnggLSB0aGlzLndpZHRoIC8gMixcbiAgICAgIHRoaXMucG9zaXRpb24ueSAtIHRoaXMuaGVpZ2h0IC8gMixcbiAgICAgIHRoaXMud2lkdGgsXG4gICAgICB0aGlzLmhlaWdodFxuICAgICk7XG4gIH07XG59XG4iLCJpbXBvcnQgeyBQaHlzaWNzIH0gZnJvbSBcIi4vYXBwL1BoeXNpY3NcIjtcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSBcIi4vYXBwL1JlbmRlcmVyXCI7XG5pbXBvcnQgeyBHYW1lIH0gZnJvbSBcIi4vYXBwL0FwcFwiO1xuXG5jb25zdCBnYW1lID0gbmV3IEdhbWUoKTtcbmdhbWUuc3RhcnQoKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=